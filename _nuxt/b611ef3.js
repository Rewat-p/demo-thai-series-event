(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{396:function(e,t,n){var content=n(430);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(81).default)("1c745dc7",content,!0,{sourceMap:!1})},429:function(e,t,n){"use strict";n(396)},430:function(e,t,n){var r=n(80)(!1);r.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),r.push([e.i,".winner-list[data-v-ca9c0c94]{position:relative;height:100%;overflow:hidden}.winner-list__title[data-v-ca9c0c94]{padding-top:16px}.winner-list__content[data-v-ca9c0c94]{min-width:260px;min-height:200px;padding:0 16px 16px;overflow:hidden;overflow-y:auto;scrollbar-width:none}.winner-list__content[data-v-ca9c0c94]::-webkit-scrollbar{width:0;height:0}.winner-list__actions[data-v-ca9c0c94]{visibility:hidden;display:flex;position:absolute;top:8px;right:0;padding:4px 8px}.winner-list:hover>.winner-list__actions[data-v-ca9c0c94]{visibility:visible}",""]),e.exports=r},467:function(e,t,n){"use strict";n.r(t);var r=n(476),o=n(494),c=n(376),l=(n(25),n(45),n(30),n(46),n(12));n(51),n(29),n(4),n(55),n(26),n(74);function f(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h={name:"WinnerList",filters:{display_code:function(e){return("000"+e).slice(-3)}},data:function(){return{maxHeight:100,currentReward:{},logs:[],fontSize:1}},computed:{items:function(){var e=this;return this.logs.filter((function(t){return t.reward_id===e.currentReward.id}))},fontSizeTitle:function(){return this.fontSize},fontSizeContent:function(){return 2*this.fontSize}},mounted:function(){this.initEvent()},methods:{onResize:function(){var e=document.querySelector(".winner-list").parentElement.offsetHeight,title=document.querySelector(".winner-list__title");console.log("root height",e),this.maxHeight=e-title.offsetHeight},initEvent:function(){var e=this;try{this.$fire.database.ref("logs").orderByChild("status").equalTo("confirmed").on("value",(function(t){var n=t.val()||{},r=Object.keys(n).map((function(e){return d(d({},n[e]),{},{ref:e})}));e.logs=r,e.onResize(),e.updateContentScroll()})),this.$fire.database.ref("game/reward").on("value",(function(t){var n=t.val()||{};e.currentReward=n}))}catch(e){console.error(e)}},handleFontSizeDecrement:function(){this.fontSize-=.05},handleFontSizeIncrement:function(){this.fontSize+=.05},updateContentScroll:function(){setTimeout((function(){var content=document.querySelector(".winner-list__content");content.scrollTop=content.scrollHeight,console.log(content.scrollHeight)}),100)}}},v=(n(429),n(65)),component=Object(v.a)(h,(function(){var e=this,t=e._self._c;return t("div",{directives:[{def:c.a,name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"winner-list"},[t("div",{staticClass:"winner-list__title",style:{fontSize:e.fontSizeTitle+"rem",lineHeight:e.fontSizeTitle+"rem"}}),e._v(" "),t("div",{staticClass:"winner-list__content",style:{maxHeight:e.maxHeight+"px"}},[e._l(e.items,(function(n){return[t("div",{key:n.ref,staticClass:"winner-list__item",style:{fontSize:e.fontSizeContent+"rem",lineHeight:1.8*e.fontSizeContent+"rem"}},[e._v("\n        "+e._s(e._f("display_code")(n.code))+"\n      ")])]}))],2),e._v(" "),t("div",{staticClass:"winner-list__actions"},[t("div",{staticClass:"d-flex",staticStyle:{height:"100%"}},[t(o.a,{attrs:{max:"3",min:"1",step:"0.05",color:"primary",height:"160","always-dirty":"",dense:"","hide-details":"",vertical:""},scopedSlots:e._u([{key:"prepend",fn:function(){return[t(r.a,{attrs:{color:"primary"},on:{click:e.handleFontSizeDecrement}},[e._v("\n            mdi-minus\n          ")])]},proxy:!0},{key:"append",fn:function(){return[t(r.a,{attrs:{color:"primary"},on:{click:e.handleFontSizeIncrement}},[e._v("\n            mdi-plus\n          ")])]},proxy:!0}]),model:{value:e.fontSize,callback:function(t){e.fontSize=t},expression:"fontSize"}})],1)])])}),[],!1,null,"ca9c0c94",null);t.default=component.exports},492:function(e,t,n){var content=n(516);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(81).default)("43210a7d",content,!0,{sourceMap:!1})},493:function(e,t,n){var content=n(518);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(81).default)("7770a59e",content,!0,{sourceMap:!1})},515:function(e,t,n){"use strict";n(492)},516:function(e,t,n){var r=n(80)(!1);r.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),r.push([e.i,".screen__box{display:flex;justify-content:center;align-items:center;font-size:8rem}",""]),e.exports=r},517:function(e,t,n){"use strict";n(493)},518:function(e,t,n){var r=n(80)(!1);r.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),r.push([e.i,".screen__container[data-v-2f9c349c]{background-color:#00b13f;display:flex;align-items:center;justify-content:center}.screen__content[data-v-2f9c349c]{position:relative;width:100%;max-width:860px;display:flex}.screen__content[data-v-2f9c349c],.screen__content *[data-v-2f9c349c]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.screen__item[data-v-2f9c349c]{margin-left:12px;margin-right:12px;background-color:#fff;border-radius:50%;overflow:hidden}.screen__boxes[data-v-2f9c349c]{transition:transform 1s ease-in-out}.winner-window[data-v-2f9c349c]{position:absolute;top:16px;right:16px;cursor:move}.winner-window__box[data-v-2f9c349c]{background:hsla(0,0%,100%,.3);box-shadow:0 4px 30px rgba(0,0,0,.1);backdrop-filter:blur(4.7px);-webkit-backdrop-filter:blur(4.7px);border:1px solid hsla(0,0%,100%,.1);border-radius:8px}",""]),e.exports=r},583:function(e,t,n){"use strict";n.r(t);var r=n(489),o=n(376),c=(n(31),n(56),n(27),n(25),n(57),n(66),n(26),n(45),n(46),n(12)),l=n(8),f=n(373),d=n(15);n(47),n(4),n(30),n(29),n(51),n(74),n(23),n(24);function h(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var y={name:"ScreenPage",data:function(){return{boxSize:100,items:[1,2,3,4,5,6,7,8,9,0],spinning:!1,startRef:null,isWinnerMouseDown:!1,winnerOffset:[0,0],maxWinnerHeight:100,originalWinnerWidth:100,showWinnerList:!0}},mounted:function(){this.initEvent(),this.init();var e=document.querySelector("#winner_list");e.addEventListener("mouseup",this.handleOnWinnerMouseUp),e.addEventListener("mouseleave",this.handleOnWinnerMouseUp),e.addEventListener("mousedown",this.handleOnWinnerMouseDown),e.addEventListener("mousemove",this.handleOnWinnerMouseMove)},beforeDestroy:function(){var e=document.querySelector("#winner_list");e.removeEventListener("mouseup",this.handleOnWinnerMouseUp),e.removeEventListener("mouseleave",this.handleOnWinnerMouseUp),e.removeEventListener("mousedown",this.handleOnWinnerMouseDown),e.removeEventListener("mousemove",this.handleOnWinnerMouseMove)},methods:{onResize:function(){var e=Math.min(window.innerWidth,860)-69;this.boxSize=e/3;var t=window.innerHeight;this.maxWinnerHeight=t-32},initEvent:function(){var e=this;try{this.$fire.database.ref("game/stage").on("value",(function(t){var n=t.val();console.log("stage",n);var r=n.status,code=n.code;"ready"===r?e.handleReset():"spinning"===r&&(e.handleReset(),e.spin(code))}))}catch(e){console.error(e)}},init:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=document.querySelectorAll(".screen__item");o=Math.min(1,o);var l,h=0,v=m(c);try{var w=function(){var c=l.value;if(n)c.dataset.spinned="0";else if("1"===c.dataset.spinned)return{v:void 0};var d=c.querySelector(".screen__boxes"),v=d.cloneNode(!1),m=["0"];if(!n){r=Math.min(1,r);for(var w=[],i=0;i<r;i++)w.push.apply(w,Object(f.a)(t.items));console.log(t.shuffle(w)),m.push.apply(m,Object(f.a)(t.shuffle(w))),m.push(e[h]),v.addEventListener("transitionstart",(function(){c.dataset.spinned="1",d.querySelectorAll(".screen__box").forEach((function(e){e.style.filter="blur(1px)"}))}),{once:!0}),v.addEventListener("transitionend",(function(){d.querySelectorAll(".screen__box").forEach((function(e,t){e.style.filter="blur(0)",t>0&&d.removeChild(e)}))}),{once:!0})}for(var y=m.length-1;y>=0;y--){var _=document.createElement("div");_.classList.add("screen__box"),_.style.width=t.boxSize+"px",_.style.height=t.boxSize+"px",_.textContent=m[y],v.appendChild(_)}v.style.transitionDuration="".concat(o,"s"),v.style.transform="translateY(-".concat(c.clientHeight*(m.length-1),"px)"),c.replaceChild(v,d),h+=1};for(v.s();!(l=v.n()).done;){var y=w();if("object"===Object(d.a)(y))return y.v}}catch(e){v.e(e)}finally{v.f()}},getReward:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$fire.database.ref("game/reward").once("value");case 2:return n=t.sent,r=n.val(),t.next=6,e.$fire.database.ref("rewards").child(r.ref).once("value");case 6:return o=t.sent,c=o.val(),t.abrupt("return",v(v({},c),{},{ref:r.ref}));case 9:case"end":return t.stop()}}),t)})))()},spin:function(code){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,c,l,f,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.spinning){t.next=2;break}return t.abrupt("return");case 2:e.spinning=!0,n=("000"+code).slice(-3).split(""),console.log("lucky",n),e.init(n,!1,1,2),r=document.querySelectorAll(".screen__item"),o=m(r),t.prev=8,l=regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,n=t.querySelector(".screen__boxes"),r=parseInt(n.style.transitionDuration),n.style.transform="translateY(0)",e.next=6,new Promise((function(e){return setTimeout(e,100*r)}));case 6:case"end":return e.stop()}}),e)})),o.s();case 11:if((c=o.n()).done){t.next=15;break}return t.delegateYield(l(),"t0",13);case 13:t.next=11;break;case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(8),o.e(t.t1);case 20:return t.prev=20,o.f(),t.finish(20);case 23:return t.next=25,new Promise((function(e){return setTimeout(e,900)}));case 25:return t.next=27,e.getReward();case 27:return f=t.sent,d=f.qty-f.draws<1?"break":"spined",console.log("status",d),t.next=32,e.$fire.database.ref("game/stage").update({status:d});case 32:case"end":return t.stop()}}),t,null,[[8,17,20,23]])})))()},shuffle:function(e){for(var t=e.length;t>0;){var n=Math.floor(Math.random()*t),r=e[t-=1];e[t]=e[n],e[n]=r}return e},handleReset:function(){this.spinning=!1,this.init()},handleSpin:function(){var e=Math.floor(501*Math.random());this.spin(e)},inParent:function(e,t){return!!e.contains(t)},handleOnWinnerMouseDown:function(e){var t=document.querySelector("#winner_list");this.inParent(document.querySelector(".winner-list__actions"),e.target)||(this.isWinnerMouseDown=!0,this.originalWinnerWidth=t.offsetWidth,this.winnerOffset=[t.offsetLeft-e.clientX,t.offsetTop-e.clientY],console.log("mouse down",this.isWinnerMouseDown,this.winnerOffset))},handleOnWinnerMouseUp:function(e){this.isWinnerMouseDown=!1,console.log("mouse up")},handleOnWinnerMouseMove:function(e){e.preventDefault();var t=document.querySelector("#winner_list");this.isWinnerMouseDown&&(t.style.left=e.clientX+this.winnerOffset[0]+"px",t.style.top=e.clientY+this.winnerOffset[1]+"px",t.style.right=window.innerWidth-(e.clientX+this.winnerOffset[0]+this.originalWinnerWidth)+"px",console.log("mouse move",e.clientX+this.winnerOffset[0],this.originalWinnerWidth))}}},_=y,x=(n(515),n(517),n(65)),component=Object(x.a)(_,(function(){var e=this,t=e._self._c;return t("div",{directives:[{def:o.a,name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"screen__container fill-height"},[t("div",{staticClass:"screen__content",attrs:{id:"content"}},[t("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[t("div",{staticClass:"screen__boxes"})]),e._v(" "),t("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[t("div",{staticClass:"screen__boxes"})]),e._v(" "),t("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[t("div",{staticClass:"screen__boxes"})])]),e._v(" "),t("div",{staticStyle:{position:"absolute",opacity:"0"}},[t(r.a,{on:{click:function(t){e.showWinnerList=!e.showWinnerList}}},[e._v("show winner")])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticStyle:{position:"absolute",top:"16px",right:"16px"}},[t(r.a,{on:{click:e.handleSpin}},[e._v("spin")]),e._v(" "),t(r.a,{on:{click:e.handleReset}},[e._v("reset")])],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showWinnerList,expression:"showWinnerList"}],staticClass:"winner-window",attrs:{id:"winner_list"}},[t("div",{staticClass:"winner-window__box",style:{height:e.maxWinnerHeight+"px"}},[t("winner-list")],1)])])}),[],!1,null,"2f9c349c",null);t.default=component.exports;installComponents(component,{WinnerList:n(467).default})}}]);