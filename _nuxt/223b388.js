(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{431:function(e,n,t){var content=t(474);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(81).default)("43210a7d",content,!0,{sourceMap:!1})},432:function(e,n,t){var content=t(476);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,t(81).default)("7770a59e",content,!0,{sourceMap:!1})},473:function(e,n,t){"use strict";t(431)},474:function(e,n,t){var r=t(80)(!1);r.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),r.push([e.i,".screen__box{display:flex;justify-content:center;align-items:center;font-size:8rem}",""]),e.exports=r},475:function(e,n,t){"use strict";t(432)},476:function(e,n,t){var r=t(80)(!1);r.push([e.i,"@import url(https://fonts.googleapis.com/css2?family=Kanit:wght@100;300;400;500;600;700&display=swap);"]),r.push([e.i,".screen__container[data-v-2f9c349c]{background-color:#00b13f;display:flex;align-items:center;justify-content:center}.screen__content[data-v-2f9c349c]{position:relative;width:100%;max-width:860px;display:flex}.screen__content[data-v-2f9c349c],.screen__content *[data-v-2f9c349c]{-webkit-user-select:none;-moz-user-select:none;user-select:none}.screen__item[data-v-2f9c349c]{margin-left:12px;margin-right:12px;background-color:#fff;border-radius:50%;overflow:hidden}.screen__boxes[data-v-2f9c349c]{transition:transform 1s ease-in-out}.winner-window[data-v-2f9c349c]{position:absolute;top:16px;right:16px;cursor:move}.winner-window__box[data-v-2f9c349c]{background:hsla(0,0%,100%,.3);box-shadow:0 4px 30px rgba(0,0,0,.1);backdrop-filter:blur(4.7px);-webkit-backdrop-filter:blur(4.7px);border:1px solid hsla(0,0%,100%,.1);border-radius:8px}",""]),e.exports=r},573:function(e,n,t){"use strict";t.r(n);var r=t(426),o=t(383),c=(t(31),t(56),t(25),t(23),t(57),t(66),t(24),t(45),t(46),t(12)),l=t(9),f=t(375),d=t(15);t(50),t(4),t(29),t(30),t(51),t(74),t(26),t(27);function h(object,e){var n=Object.keys(object);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(object);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),n.push.apply(n,t)}return n}function v(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(n){Object(c.a)(e,n,source[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(source,n))}))}return e}function m(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"==typeof e)return w(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w(e,n)}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==t.return||t.return()}finally{if(l)throw o}}}}function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,t=new Array(n);i<n;i++)t[i]=e[i];return t}var x={name:"ScreenPage",data:function(){return{boxSize:100,items:[1,2,3,4,5,6,7,8,9,0],spinning:!1,startRef:null,isWinnerMouseDown:!1,winnerOffset:[0,0],maxWinnerHeight:100,originalWinnerWidth:100,showWinnerList:!0}},mounted:function(){this.initEvent(),this.init();var e=document.querySelector("#winner_list");e.addEventListener("mouseup",this.handleOnWinnerMouseUp),e.addEventListener("mouseleave",this.handleOnWinnerMouseUp),e.addEventListener("mousedown",this.handleOnWinnerMouseDown),e.addEventListener("mousemove",this.handleOnWinnerMouseMove)},beforeDestroy:function(){var e=document.querySelector("#winner_list");e.removeEventListener("mouseup",this.handleOnWinnerMouseUp),e.removeEventListener("mouseleave",this.handleOnWinnerMouseUp),e.removeEventListener("mousedown",this.handleOnWinnerMouseDown),e.removeEventListener("mousemove",this.handleOnWinnerMouseMove)},methods:{onResize:function(){var e=Math.min(window.innerWidth,860)-69;this.boxSize=e/3;var n=window.innerHeight;this.maxWinnerHeight=n-32},initEvent:function(){var e=this;try{this.$fire.database.ref("game/stage").on("value",(function(n){var t=n.val();console.log("stage",t);var r=t.status,code=t.code;"ready"===r?e.handleReset():"spinning"===r&&(e.handleReset(),e.spin(code))}))}catch(e){console.error(e)}},init:function(e){var n=this,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=document.querySelectorAll(".screen__item");o=Math.min(1,o);var l,h=0,v=m(c);try{var w=function(){var c=l.value;if(t)c.dataset.spinned="0";else if("1"===c.dataset.spinned)return{v:void 0};var d=c.querySelector(".screen__boxes"),v=d.cloneNode(!1),m=["0"];if(!t){r=Math.min(1,r);for(var w=[],i=0;i<r;i++)w.push.apply(w,Object(f.a)(n.items));console.log(n.shuffle(w)),m.push.apply(m,Object(f.a)(n.shuffle(w))),m.push(e[h]),v.addEventListener("transitionstart",(function(){c.dataset.spinned="1",d.querySelectorAll(".screen__box").forEach((function(e){e.style.filter="blur(1px)"}))}),{once:!0}),v.addEventListener("transitionend",(function(){d.querySelectorAll(".screen__box").forEach((function(e,n){e.style.filter="blur(0)",n>0&&d.removeChild(e)}))}),{once:!0})}for(var x=m.length-1;x>=0;x--){var y=document.createElement("div");y.classList.add("screen__box"),y.style.width=n.boxSize+"px",y.style.height=n.boxSize+"px",y.textContent=m[x],v.appendChild(y)}v.style.transitionDuration="".concat(o,"s"),v.style.transform="translateY(-".concat(c.clientHeight*(m.length-1),"px)"),c.replaceChild(v,d),h+=1};for(v.s();!(l=v.n()).done;){var x=w();if("object"===Object(d.a)(x))return x.v}}catch(e){v.e(e)}finally{v.f()}},getReward:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var t,r,o,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.$fire.database.ref("game/reward").once("value");case 2:return t=n.sent,r=t.val(),n.next=6,e.$fire.database.ref("rewards").child(r.ref).once("value");case 6:return o=n.sent,c=o.val(),n.abrupt("return",v(v({},c),{},{ref:r.ref}));case 9:case"end":return n.stop()}}),n)})))()},spin:function(code){var e=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var t,r,o,c,l,f,d;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.spinning){n.next=2;break}return n.abrupt("return");case 2:e.spinning=!0,t=("000"+code).slice(-3).split(""),console.log("lucky",t),e.init(t,!1,1,2),r=document.querySelectorAll(".screen__item"),o=m(r),n.prev=8,l=regeneratorRuntime.mark((function e(){var n,t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.value,t=n.querySelector(".screen__boxes"),r=parseInt(t.style.transitionDuration),t.style.transform="translateY(0)",e.next=6,new Promise((function(e){return setTimeout(e,100*r)}));case 6:case"end":return e.stop()}}),e)})),o.s();case 11:if((c=o.n()).done){n.next=15;break}return n.delegateYield(l(),"t0",13);case 13:n.next=11;break;case 15:n.next=20;break;case 17:n.prev=17,n.t1=n.catch(8),o.e(n.t1);case 20:return n.prev=20,o.f(),n.finish(20);case 23:return n.next=25,new Promise((function(e){return setTimeout(e,900)}));case 25:return n.next=27,e.getReward();case 27:return f=n.sent,d=f.qty-f.draws<1?"break":"spined",console.log("status",d),n.next=32,e.$fire.database.ref("game/stage").update({status:d});case 32:case"end":return n.stop()}}),n,null,[[8,17,20,23]])})))()},shuffle:function(e){for(var n=e.length;n>0;){var t=Math.floor(Math.random()*n),r=e[n-=1];e[n]=e[t],e[t]=r}return e},handleReset:function(){this.spinning=!1,this.init()},handleSpin:function(){var e=Math.floor(501*Math.random());this.spin(e)},inParent:function(e,n){return!!e.contains(n)},handleOnWinnerMouseDown:function(e){var n=document.querySelector("#winner_list");this.inParent(document.querySelector(".winner-list__actions"),e.target)||(this.isWinnerMouseDown=!0,this.originalWinnerWidth=n.offsetWidth,this.winnerOffset=[n.offsetLeft-e.clientX,n.offsetTop-e.clientY],console.log("mouse down",this.isWinnerMouseDown,this.winnerOffset))},handleOnWinnerMouseUp:function(e){this.isWinnerMouseDown=!1,console.log("mouse up")},handleOnWinnerMouseMove:function(e){e.preventDefault();var n=document.querySelector("#winner_list");this.isWinnerMouseDown&&(n.style.left=e.clientX+this.winnerOffset[0]+"px",n.style.top=e.clientY+this.winnerOffset[1]+"px",n.style.right=window.innerWidth-(e.clientX+this.winnerOffset[0]+this.originalWinnerWidth)+"px",console.log("mouse move",e.clientX+this.winnerOffset[0],this.originalWinnerWidth))}}},y=x,_=(t(473),t(475),t(65)),component=Object(_.a)(y,(function(){var e=this,n=e._self._c;return n("div",{directives:[{def:o.a,name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],staticClass:"screen__container fill-height"},[n("div",{staticClass:"screen__content",attrs:{id:"content"}},[n("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[n("div",{staticClass:"screen__boxes"})]),e._v(" "),n("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[n("div",{staticClass:"screen__boxes"})]),e._v(" "),n("div",{staticClass:"screen__item",style:{width:e.boxSize+"px",height:e.boxSize+"px"}},[n("div",{staticClass:"screen__boxes"})])]),e._v(" "),n("div",{staticStyle:{position:"absolute",opacity:"0"}},[n(r.a,{on:{click:function(n){e.showWinnerList=!e.showWinnerList}}},[e._v("show winner")])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticStyle:{position:"absolute",top:"16px",right:"16px"}},[n(r.a,{on:{click:e.handleSpin}},[e._v("spin")]),e._v(" "),n(r.a,{on:{click:e.handleReset}},[e._v("reset")])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showWinnerList,expression:"showWinnerList"}],staticClass:"winner-window",attrs:{id:"winner_list"}},[n("div",{staticClass:"winner-window__box",style:{height:e.maxWinnerHeight+"px"}},[n("winner-list")],1)])])}),[],!1,null,"2f9c349c",null);n.default=component.exports;installComponents(component,{WinnerList:t(459).default})}}]);